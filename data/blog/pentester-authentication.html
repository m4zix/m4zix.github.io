<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PentesterLab Authentication 01‚Äì05</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../../styles.css">
</head>
<body class="bg-gray-900 text-white p-8 font-mono">

  <header class="flex justify-between items-center p-5 mb-10 border-b border-green-800 sticky top-0 z-50 bg-gray-900 backdrop-blur-sm">
    <a href="../../index.html"><h1 class="text-3xl font-bold font-mono text-green-400">>_ M4ZiX:~</h1></a>
  </header>

  <div class="max-w-4xl mx-auto">
    <h1 class="text-4xl text-green-400 font-bold mb-6">PentesterLab Authentication 01‚Äì05</h1>
    <p class="mb-2 text-sm text-gray-400">Tags: Authentication, Web Security, Header Injection, Session Logic, Pentesting</p>
    <hr class="my-4 border-green-700">

    <section class="mb-10">
      <h2 class="text-2xl text-green-300 mb-2">üéØ Goal</h2>
      <p>Explore common authentication flaws and how weak implementations can be exploited. Learn how header manipulation, poor hashing, and misconfigured logic can lead to unauthorized access.</p>
    </section>

    <section class="mb-10">
      <h2 class="text-2xl text-green-300 mb-4">üõ†Ô∏è Walkthrough</h2>

      <h3 class="text-xl text-green-200 mt-6 mb-2">Authentication 01 ‚Äî Custom Header Bypass</h3>
      <p>Using a proxy tool like Burp Suite, we intercepted the login request and noticed a custom header: <code>Auth: user</code>. Changing the header value to <code>Auth: admin</code> granted admin-level access. This indicates that the server trusts header data blindly without additional validation or checks.</p>

      <h3 class="text-xl text-green-200 mt-6 mb-2">Authentication 02 ‚Äî MD5 Hashed Header</h3>
      <p>This lab uses a hashed value in the authentication header. By analyzing the 32-character hash, we identified it as an MD5 hash. We generated <code>md5("admin")</code> using a tool or script and replaced the header with the result, successfully logging in. This highlights the risk of static hashing without a salt or dynamic mechanism.</p>

      <h3 class="text-xl text-green-200 mt-6 mb-2">Authentication 03 ‚Äî Case Sensitivity</h3>
      <p>We attempted various capitalization formats such as <code>Admin</code>, <code>aDmIN</code>, and <code>ADMIN</code>. Some variations unexpectedly passed authentication, indicating inconsistent case handling between user input and database matching. This suggests that the backend comparison might be using case-sensitive checks where it shouldn't.</p>

      <h3 class="text-xl text-green-200 mt-6 mb-2">Authentication 04 ‚Äî Trailing Space Exploit</h3>
      <p>During the registration phase, we created a user with a trailing space: <code>admin </code>. The system stored this value in the database. During login, the backend trimmed whitespace, allowing us to bypass user uniqueness or duplicate validation checks. This inconsistency between stored and validated values allowed access to an admin-level session.</p>

      <h3 class="text-xl text-green-200 mt-6 mb-2">Authentication 05 ‚Äî Redirect Leak</h3>
      <p>After attempting access to the admin panel without credentials, the server responded with a <code>302</code> redirect to the login page. However, the HTML body still contained admin content due to a missing <code>exit()</code> or <code>die()</code> after the redirect. This behavior allows a potential attacker to read or parse sensitive information from the response body despite the redirect.</p>
    </section>

    <section class="mt-10">
      <h2 class="text-2xl text-red-400 mb-2">üîê How to Prevent These Vulnerabilities</h2>
      <ul class="list-disc list-inside">
        <li>Use secure authentication mechanisms such as token-based systems (JWT, OAuth).</li>
        <li>Never rely solely on client-side data or headers for critical authentication decisions.</li>
        <li>Hash and salt passwords using strong algorithms like bcrypt or Argon2.</li>
        <li>Normalize and sanitize all user input before processing (including trimming and case folding).</li>
        <li>Terminate server-side execution immediately after redirects to avoid content leakage.</li>
        <li>Implement input validation and duplicate checks robustly at both front-end and back-end.</li>
      </ul>
    </section>

    <section class="mt-10">
      <h2 class="text-2xl text-blue-400 mb-2">üß≠ Methodology for Pentesters</h2>
      <ul class="list-disc list-inside">
        <li>Start with common weak credentials (admin/admin, guest/guest, etc.).</li>
        <li>Use tools like Burp Suite or ZAP to intercept and analyze HTTP traffic.</li>
        <li>Check for custom headers or cookies that might control access levels.</li>
        <li>Try variations in input such as case changes or whitespace additions.</li>
        <li>Attempt to identify encoding or hashing techniques (e.g., MD5, Base64).</li>
        <li>Monitor HTTP status codes, especially redirects (301/302), for data leakage.</li>
        <li>Always document the steps taken, tools used, and vulnerabilities found responsibly.</li>
      </ul>
    </section>

    <section class="mt-10">
      <p class="text-sm text-gray-400">This write-up is for educational purposes only. It does not share solutions, violate PentesterLab‚Äôs terms, or disclose any protected flags. Written and shared with respect to ethical hacking principles by M4ZiX.</p>
    </section>
  </div>

</body>
</html>
